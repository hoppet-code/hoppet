\section{Perturbative evolution in QCD}
\label{sec:pqcd}
First of all we set up the notation and
conventions that are used throughout \hoppet. The DGLAP
equation for a non-singlet parton distribution reads
\begin{equation}
  \label{eq:dglap-ns}
  \frac{\partial q(x,Q^2)}{\partial \ln Q^2} = 
\frac{\aq}{2\pi}\int_x^1 \frac{dz}{z}
  P(z,\aq) q\lp \frac{x}{z},Q^2\rp \equiv 
\frac{\aq}{2\pi}  P(x,\aq) \otimes q\lp x,Q^2\rp \ .
\end{equation}
The related variable $t\equiv \ln Q^2$ is also used
in various places in \hoppet.
The splitting functions in eq.~(\ref{eq:dglap-ns})
are known exactly up to NNLO in the 
unpolarised case \cite{Furmanski:1980cm,Curci:1980uw,NNLO-NS,NNLO-singlet}, and approximately at N$^3$LO~\cite{Gracey:1994nn,Davies:2016jie,Moch:2017uml,Gehrmann:2023cqm,Falcioni:2023tzp,Gehrmann:2023iah,McGowan:2022nag,NNPDF:2024nan,Moch:2021qrk,Falcioni:2023luc,Falcioni:2023vqq,Moch:2023tdj,Falcioni:2024xyt,Falcioni:2024qpd}:
\begin{equation}
  \label{eq:dpdf}
   P(z,\aq)=P^{(0)}(z)+\frac{\aq}{2\pi}P^{(1)}(z)+
\lp \frac{\aq}{2\pi} \rp^2 P^{(2)}(z) 
+
\lp \frac{\aq}{2\pi} \rp^3 P^{(3)}(z) \ ,
\end{equation}
and up to NNLO \cite{Mertig:1995ny,Vogelsang:1996im,Moch:2014sna,Moch:2015usa,Blumlein:2021enk,Blumlein:2021ryt} in the polarised case.
The generalisation to the singlet case is straightforward, as it
is 
%the generalisation of eq.~(\ref{eq:dglap-ns}) 
to the case of time-like evolution\footnote{
The general structure of the relation between space-like
and time-like evolution and splitting functions
 has been investigated in
 \cite{Furmanski:1980cm,Curci:1980uw,Stratmann:1996hn,Dokshitzer:2005bf,Mitov:2006ic,Basso:2006nk,Dokshitzer:2006nm,Beccaria:2007bb}.
 %
 See references to those articles for more recent updates.
}, 
relevant for example for fragmentation function analysis,
where NNLO results
are also available \cite{Mitov:2006ic,Moch:2007tx,Almasy:2011eq}.


As with the splitting functions, all perturbative quantities in
\hoppet are defined to be coefficients of powers of $\as/2\pi$. The one
exception is the $\beta$-function coefficients of the running
coupling equation:
\begin{equation}
  \label{eq:as-ev}
  \frac{d\as}{d\ln Q^2} = \beta\lp \aq\rp = -\as (\beta_0\as +
  \beta_1\as^2 + 
  \beta_2\as^3 + 
  \beta_3\as^4) \ .
\end{equation}

The evolution of the strong coupling and the parton distributions can
be performed in both the fixed flavour-number scheme (FFNS) and the 
variable flavour-number scheme (VFNS). In the VFNS case we 
need the matching conditions between the effective
theories with $n_f$ and $n_{f}+1$ light flavours for both the strong 
coupling $\aq$ and the parton distributions at the heavy quark
mass threshold $m_h^2$.

These matching conditions for the parton distributions
receive non-trivial contributions at higher orders. In the $\MSbar$
(factorisation) scheme, for example,
carrying out the matching at a scale equal to the heavy-quark mass,
these begin at NNLO:\footnote{In
  a general scheme they would start at NLO.} %
for light quarks $q_{l,i}$ of flavour $i$ 
(quarks that are considered massless
below the heavy quark mass threshold $m_h^2$) the matching between
their values in the $n_f$ and
$n_f+1$ effective theories reads\footnote{Note that the literature
  focuses on the $q_{l,i}+q_{l,-i}$ combination. We thank Johannes
  Bl\"umlein for having provided the $A^{\rm NS,-}_{qq,h}(x)$ code
  needed for the $q_{l,i}-q_{l,-i}$ combination.}:
%\begin{equation}
%\label{eq:lp-nf1}
%  q_{l,i}^{\,(n_f+1)}(x,m_h^2) \: = \:  q_{l,i}^{\,(\nf}(x,m_h^2) +
%\lp \frac{\alpha_s(m_h^2)}{2\pi} \rp^2
%   A^{\rm ns,(2)}_{qq,h}(x) \otimes
%  q_{l,i}^{\, (\nf}(x,m_h^2) \ ,
%\end{equation}
\begin{align}
\label{eq:lp-nf1}
  q_{l,i}^{\,(n_f+1)}(x,m_h^2) + q_{l,-i}^{\,(n_f+1)}(x,m_h^2)  & =   q_{l,i}^{\,(\nf}(x,m_h^2) + q_{l,-i}^{\,(\nf}(x,m_h^2) \notag \\ &+
   A^{\rm NS,+}_{qq,h}(x) \otimes \left(
   q_{l,i}^{\, (\nf}(x,m_h^2) + q_{l,-i}^{\, (\nf}(x,m_h^2)\right) \notag\\
   & + \frac{1}{n_f} \Big\{A^{\rm PS}_{qq,h}(x) \otimes \Sigma^{\, (\nf}(x,m_h^2) \notag\\
   & + A^{\rm S}_{qg,h}(x) \otimes g^{\, (\nf}(x,m_h^2)\Big\} \ , \notag \\
  q_{l,i}^{\,(n_f+1)}(x,m_h^2) - q_{l,-i}^{\,(n_f+1)}(x,m_h^2)  & =   q_{l,i}^{\,(\nf}(x,m_h^2) - q_{l,-i}^{\,(\nf}(x,m_h^2) \notag \\ &+
   A^{\rm NS,-}_{qq,h}(x) \otimes \left(
   q_{l,i}^{\, (\nf}(x,m_h^2) - q_{l,-i}^{\, (\nf}(x,m_h^2)\right) \ ,
\end{align}
where $i = 1,\ldots n_f$, while for the gluon distribution, the heavy
quark PDF $q_h$, and the singlet PDF $\Sigma(x,Q^2)$ (defined in
Table~\ref{eq:diag_split}) one has :
\begin{align}
\label{eq:hp-nf1}
  g^{(n_f+1)}(x,m_h^2)  &=
    g^{\, (\nf}(x,m_h^2) +
    A_{\rm gq,h}^{\rm S}(x) \otimes \Sigma^{(\nf}(x,m_h^2) +
    A_{\rm gg,h}^{\rm S}(x) \otimes g^{(\nf}(x,m_h^2) \ ,
  \nn \\[0.3cm]
  (q_h+\bar{q}_{h})^{(n_f+1)}(x,m_h^2)  &=
  A_{\rm hq}^{\rm S}(x)\otimes \Sigma^{(\nf}(x,m_h^2) 
  + A_{\rm hg}^{\rm S}(x)\otimes g^{(\nf}(x,m_h^2)\ ,  \nn \\[0.3cm]
  \Sigma^{(n_f+1)}(x,m_h^2)  &= \Sigma^{\, (\nf}(x,m_h^2) + \left[ A^{\rm NS,+}_{qq,h}(x) + A^{\rm PS}_{qq,h}(x) + A_{\rm hq}^{\rm S}(x)\right] \otimes \Sigma^{(\nf}(x,m_h^2) \nn \\
  & + \left[ A^{\rm S}_{qg,h}(x) + A_{\rm hg}^{\rm S}(x) \right] \otimes g^{(\nf}(x,m_h^2)
\end{align}
with $q_h=\bar{q}_h$. Up to N$^3$LO the matching coefficients have the
following expansions in $\alpha_s$
\begin{align}
  A^{\rm NS,\pm}_{qq,h}(x) & = \lp \frac{\alpha_s(m_h^2)}{2\pi} \rp^2
  A^{\rm NS,\pm,(2)}_{qq,h}(x) + \lp \frac{\alpha_s(m_h^2)}{2\pi} \rp^3
  A^{\rm NS,\pm,(3)}_{qq,h}(x) \ , \nn \\
  A^{\rm S}_{gk,h}(x) & = \lp \frac{\alpha_s(m_h^2)}{2\pi} \rp^2
  A^{\rm S,(2)}_{gk,h}(x) + \lp \frac{\alpha_s(m_h^2)}{2\pi} \rp^3
  A^{\rm S,(3)}_{gk,h}(x), \quad k=q,g \ , \nn \\
  %A^{\rm S}_{gg,h}(x) & = \lp \frac{\alpha_s(m_h^2)}{2\pi} \rp^2
  %A^{\rm S,(2)}_{gg,h}(x) + \lp \frac{\alpha_s(m_h^2)}{2\pi} \rp^3
  %A^{\rm S,(3)}_{gg,h}(x) \ , \nn \\
  A^{\rm S}_{hk}(x) & = \lp \frac{\alpha_s(m_h^2)}{2\pi} \rp^2
  A^{\rm S,(2)}_{hk}(x) + \lp \frac{\alpha_s(m_h^2)}{2\pi} \rp^3
  A^{\rm S,(3)}_{hk}(x), \quad k=q,g \ , \nn \\
  %A^{\rm S}_{hg}(x) & = \lp \frac{\alpha_s(m_h^2)}{2\pi} \rp^2
  %A^{\rm S,(2)}_{hg}(x) + \lp \frac{\alpha_s(m_h^2)}{2\pi} \rp^3
  %A^{\rm S,(3)}_{hg}(x) \ , \nn \\
  A^{\rm PS}_{qq,h}(x) & = \lp \frac{\alpha_s(m_h^2)}{2\pi} \rp^3
  A^{\rm PS,(3)}_{qq,h}(x) \, , \nn \\
  A^{\rm S}_{qg,h}(x) & = \lp \frac{\alpha_s(m_h^2)}{2\pi} \rp^3
  A^{\rm S,(3)}_{qg,h}(x)\,.
\end{align}
At $\mathcal{O}(\alpha_S^2)$ we have that $A^{\rm NS,+}_{qq,h}(x) =
A^{\rm NS,-}_{qq,h}(x)$ whereas they start to differ at
$\mathcal{O}(\alpha_S^3)$. The NNLO matching coefficients were
computed in \cite{NNLO-MTM}\footnote{The authors are thanked for the
code corresponding to the calculation.} and the N$^3$LO matching
coefficients
in~\cite{Bierenbaum:2009mv,Ablinger:2010ty,Kawamura:2012cr,Blumlein:2012vq,ABLINGER2014263,Ablinger:2014nga,Ablinger:2014vwa,Behring:2014eya,Ablinger:2019etw,Behring:2021asx,Fael:2022miw,Ablinger:2023ahe,Ablinger:2024xtt,BlumleinCode}\footnote{We
thank Johannes Bl\"umlein for sharing the code in
Ref.~\cite{BlumleinCode} with us, which also contains code associated
with Refs.~\cite{Ablinger:2024xtt,Fael:2022miw}.
%
}
%
Notice that the above
conditions will lead to small discontinuities of the PDFs in its
evolution in $Q^2$, which are cancelled by similar matching terms in
the coefficient functions in massive VFN schemes, resulting in continuous physical
observables. In particular, the heavy-quark PDFs start from a non-zero
value at threshold at NNLO, which sometimes can even be negative.

The corresponding N$^3$LO relation for the matching of the $\MSbar$
coupling constant at the heavy quark threshold $m^2_h$ is given by 
\begin{equation}
\label{eq:as-nf1}
  \as^{\, (n_f+1)}(m_h^2) \: = \:
  \as^{\, (\nf} (m_h^2) +   C_2 \lp \frac{\as^{\, (\nf} (m_h^2)}{2\pi} \rp^3+   C_3 \lp \frac{\as^{\, (\nf} (m_h^2)}{2\pi} \rp^4
   \:\: ,
\end{equation}
where the matching coefficients $C_2$ and $C_3$ were computed in
\cite{Chetyrkin:1997sg,Chetyrkin:1997un}.
%
The value and the form of the matching coefficients in
eqs.~(\ref{eq:lp-nf1},\ref{eq:hp-nf1}) depend on the scheme used for
the quark masses; by default in \hoppet quark masses are taken to be
pole masses, though the option exists for the user to supply and have
thresholds crossed at $\MSbar$ masses, but only up to NNLO. We note
that in the current implementation in \hoppet the matching can only be
performed at the matching point that corresponds to the heavy-quark masses
themselves.

Both evolution and threshold matching preserve the momentum sum rule
\begin{equation}
  \int_0^1 dx~x \lp \Sigma(x,Q^2)+g(x,Q^2)\rp =1 \,,
\end{equation}
and valence sum rules
\begin{equation}
  \int_0^1 dx\, \left[q(x,Q^2)-{\bar q}(x,Q^2) \right] = \left\{ 
    \begin{array}{ll}
      1, & \text{for } q = d \text{ (in proton)}\\
      2, & \text{for } q = u \text{ (in proton)}\\
      0, & \text{other flavours}
    \end{array}
    \right.
\end{equation}
as long as they hold at the initial scale (occasionally not the case,
\eg in modified LO sets for Monte Carlo
generators~\cite{Sherstnev:2008dm}).

The default basis for the PDFs, called the \ttt{human} 
representation in \hoppet, is such that 
 the entries in an array
\ttt{pdf(-6:6)} of PDFs correspond to:
\bea 
\bar t={-6} \ ,  \bar b={-5} \ ,  \bar c={-4}
\ , \nn   \bar s&=&{-3} \ , \nn  \bar u={-2} \ , \nn
 \bar d={-1} \ , \\  g&=&{0} \ , \\ \nn   d={1} \ , \nn  u={2} 
\ , \nn  
s={3} \ , \nn   c&=&{4} \ , \nn b={5} \ , \nn  t={6} \ . \nn 
\eea
%  This representation is the
% same as that used in the \ttt{LHAPDF} library \cite{LHAPDF}. 
%
However, this representation leads
to a complicated form of the evolution equations.
The splitting matrix can be simplified considerably (made diagonal
except for a $2\times2$ singlet block) by switching to a different
flavour representation, which is named
the \ttt{evln} representation, for the PDF set, as explained in detail in
\cite{vanNeerven:1999ca,vanNeerven:2000uj}. This representation
is described in Table \ref{eq:diag_split}.

In the {\tt evln} basis, 
the gluon evolves coupled to the singlet  PDF $\Sigma$,
and all non-singlet PDFs evolve independently.
Notice that the representations of the PDFs
are preserved under linear operations, so in particular
they are preserved under DGLAP evolution.
The conversion from the \ttt{human} to the \ttt{evln}
representations of PDFs requires that the number of
active quark flavours $n_f$ be specified by the user, as described in
\ifreleasenote
Section~5.1.2 of Ref.~\cite{Salam:2008qg}.
\else
Section~\ref{sec:evln-rep}.
\fi

\begin{table}
\begin{center}
\begin{tabular}{|r | c | l |}
\hline
     i & \mbox{name} & $q_i$ \\ \hline
     $ -6\ldots-(n_f+1)$ & $q_i$ & $q_i$\\
     $-n_f\ldots -2$ & $q_{\mathrm{NS},i}^{-}$ & 
$(q_i -  {\bar q}_i) - (q_1 - {\bar q}_1)$\\
      -1           & $q_{\mathrm{NS}}^{V}$ & 
$\sum_{j=1}^{n_f} (q_j -  {\bar q}_j)$\\
       0           & g & \textrm{gluon} \\
       1           & $\Sigma$ & $\sum_{j=1}^{n_f} (q_j +  {\bar q}_j)$\\
     $2\ldots n_f$ & $q_{\mathrm{NS},i}^{+}$ &
$ (q_i +  {\bar q}_i) - (q_1 + {\bar q}_1)$\\
      $(n_f+1)\ldots6$ & $q_i$ & $q_i$ \\
\hline
\end{tabular}
\caption{}{\label{eq:diag_split} The evolution representation 
(called \ttt{evln} in \hoppet)
of PDFs with $n_f$ active quark flavours
in terms of the \ttt{human} representation.}  
\end{center}
\end{table}

In \hoppet, unpolarised DGLAP evolution is available up to N$^3$LO
in the $\MSbar$ scheme, while for the DIS scheme
only evolution up to NLO is available, but without the NLO heavy-quark
threshold matching conditions. For polarised evolution up to NLO only
the $\MSbar$ scheme is available. The variable \ttt{factscheme}
takes different values for each factorisation scheme:
\begin{center}
  \begin{tabular}{|c|l|}\hline
    \ttt{factscheme} & Evolution\\[2pt]\hline
    1 & unpolarised $\MSbar$ scheme\\[2pt]\hline
    2 & unpolarised DIS scheme\\[2pt]\hline
    3 & polarised $\MSbar$ scheme\\\hline
  \end{tabular}
\end{center}
Note that mass thresholds are currently
missing in the DIS scheme.
